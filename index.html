<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>PHASE I</title>
		<link rel="icon" href="../logo.jpg" />
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: "Creepster", "Segoe UI", Tahoma, Geneva, Verdana,
					sans-serif;
				background: linear-gradient(
					135deg,
					#0a0a0a 0%,
					#1a0000 50%,
					#0a0a0a 100%
				);
				min-height: 100vh;
				display: flex;
				justify-content: center;
				align-items: center;
				padding: 20px;
				position: relative;
				overflow: hidden;
			}

			body::before {
				content: "";
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: radial-gradient(
						circle at 20% 50%,
						rgba(139, 0, 0, 0.3) 0%,
						transparent 50%
					),
					radial-gradient(
						circle at 80% 80%,
						rgba(75, 0, 130, 0.3) 0%,
						transparent 50%
					);
				pointer-events: none;
				animation: eeriePulse 4s ease-in-out infinite;
			}

			@keyframes eeriePulse {
				0%,
				100% {
					opacity: 0.5;
				}
				50% {
					opacity: 0.8;
				}
			}

			.game-container {
				background: linear-gradient(145deg, #1a1a1a 0%, #2d0000 100%);
				border-radius: 20px;
				padding: 30px;
				box-shadow: 0 20px 60px rgba(139, 0, 0, 0.6),
					inset 0 0 30px rgba(0, 0, 0, 0.8), 0 0 100px rgba(255, 0, 0, 0.3);
				max-width: 800px;
				width: 100%;
				border: 2px solid #4a0000;
				position: relative;
				z-index: 1;
			}

			h1 {
				text-align: center;
				color: #ff0000;
				margin-bottom: 10px;
				text-shadow: 0 0 10px #ff0000, 0 0 20px #8b0000, 0 0 30px #4a0000;
				font-size: 32px;
				letter-spacing: 3px;
			}

			.timer {
				text-align: center;
				font-size: 24px;
				font-weight: bold;
				color: #ff4444;
				margin-bottom: 20px;
				text-shadow: 0 0 10px #ff0000;
			}

			.timer.warning {
				color: #ff6600;
				text-shadow: 0 0 15px #ff6600;
			}

			.timer.danger {
				color: #ff0000;
				animation: scaryPulse 0.5s infinite;
				text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
			}

			@keyframes scaryPulse {
				0%,
				100% {
					transform: scale(1);
					filter: brightness(1);
				}
				50% {
					transform: scale(1.15);
					filter: brightness(1.5);
				}
			}

			.items-container {
				display: flex;
				flex-wrap: wrap;
				gap: 15px;
				justify-content: center;
				margin-bottom: 30px;
				min-height: 80px;
				background: rgba(0, 0, 0, 0.4);
				padding: 20px;
				border-radius: 10px;
				border: 2px dashed #4a0000;
				box-shadow: inset 0 0 20px rgba(139, 0, 0, 0.3);
			}

			.item {
				font-size: 50px;
				cursor: grab;
				transition: transform 0.2s, filter 0.2s;
				user-select: none;
				filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.5));
			}

			.item:hover {
				transform: scale(1.2) rotate(5deg);
				filter: drop-shadow(0 0 20px rgba(255, 0, 0, 0.8));
			}

			.item.dragging {
				opacity: 0.5;
				cursor: grabbing;
				filter: drop-shadow(0 0 30px rgba(255, 0, 0, 1));
			}

			.categories {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 20px;
				margin-bottom: 20px;
			}

			.category {
				background: linear-gradient(145deg, #1a0000 0%, #0a0a0a 100%);
				border: 3px dashed #4a0000;
				border-radius: 15px;
				padding: 20px;
				min-height: 150px;
				transition: all 0.3s;
				box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8),
					0 5px 15px rgba(139, 0, 0, 0.4);
			}

			.category.drag-over {
				background: linear-gradient(145deg, #2d0000 0%, #1a0000 100%);
				border-color: #ff0000;
				transform: scale(1.05);
				box-shadow: inset 0 0 30px rgba(255, 0, 0, 0.3),
					0 0 30px rgba(255, 0, 0, 0.6);
			}

			.category h2 {
				text-align: center;
				margin-bottom: 15px;
				color: #ff4444;
				font-size: 18px;
				text-shadow: 0 0 10px #ff0000;
				letter-spacing: 2px;
			}

			.category-items {
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
				justify-content: center;
				min-height: 80px;
			}

			.message {
				text-align: center;
				font-size: 18px;
				font-weight: bold;
				margin-top: 20px;
				min-height: 30px;
				text-shadow: 0 0 10px currentColor;
			}

			.message.success {
				color: #00ff00;
				text-shadow: 0 0 20px #00ff00;
				animation: flicker 0.5s ease-in-out;
			}

			.message.error {
				color: #ff0000;
				text-shadow: 0 0 20px #ff0000;
				animation: shake 0.5s ease-in-out;
			}

			@keyframes flicker {
				0%,
				100% {
					opacity: 1;
				}
				25%,
				75% {
					opacity: 0.5;
				}
				50% {
					opacity: 1;
				}
			}

			@keyframes shake {
				0%,
				100% {
					transform: translateX(0);
				}
				25% {
					transform: translateX(-10px);
				}
				75% {
					transform: translateX(10px);
				}
			}

			.restart-btn {
				display: block;
				margin: 20px auto 0;
				padding: 12px 30px;
				font-size: 16px;
				background: linear-gradient(145deg, #4a0000 0%, #8b0000 100%);
				color: #ff4444;
				border: 2px solid #ff0000;
				border-radius: 25px;
				cursor: pointer;
				transition: all 0.3s;
				box-shadow: 0 5px 15px rgba(139, 0, 0, 0.4),
					inset 0 0 10px rgba(0, 0, 0, 0.5);
				text-shadow: 0 0 5px #ff0000;
				font-weight: bold;
				letter-spacing: 1px;
			}

			.restart-btn:hover {
				background: linear-gradient(145deg, #8b0000 0%, #4a0000 100%);
				box-shadow: 0 0 20px rgba(255, 0, 0, 0.6),
					inset 0 0 15px rgba(255, 0, 0, 0.2);
				transform: scale(1.05);
				color: #ff0000;
			}
		</style>
	</head>
	<body>
		<div class="game-container">
			<h1>WELCOME TO THE GAME</h1>
			<div class="timer">‚è±Ô∏è Time Remaining: <span id="time">0</span>s</div>

			<div class="items-container" id="itemsContainer"></div>

			<div class="categories">
				<div class="category" data-category="fruit">
					<h2>Fruits</h2>
					<div class="category-items" id="fruit"></div>
				</div>
				<div class="category" data-category="electronics">
					<h2>Electronics</h2>
					<div class="category-items" id="electronics"></div>
				</div>
			</div>

			<div class="message" id="message"></div>
		</div>

		<script>
			const items = [
				{ emoji: "üçé", category: "fruit" },
				{ emoji: "üçå", category: "fruit" },
				{ emoji: "ü•ï", category: "trap" },
				{ emoji: "üéß", category: "electronics" },
				{ emoji: "üì±", category: "electronics" },
				{ emoji: "üíª", category: "electronics" },
			];

			let timeRemaining = 25;
			let timerInterval;
			let gameCompleted = false;

			function shuffle(arr) {
				const newArr = [...arr];
				for (let i = newArr.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[newArr[i], newArr[j]] = [newArr[j], newArr[i]];
				}
				return newArr;
			}

			function initGame() {
				const container = document.getElementById("itemsContainer");
				container.innerHTML = "";

				document.getElementById("fruit").innerHTML = "";
				document.getElementById("electronics").innerHTML = "";
				document.getElementById("message").textContent = "";
				document.getElementById("message").className = "message";

				gameCompleted = false;
				timeRemaining = 60;
				updateTimerDisplay();

				clearInterval(timerInterval);
				timerInterval = setInterval(updateTimer, 1000);

				const shuffled = shuffle(items);
				shuffled.forEach((item, idx) => {
					const div = document.createElement("div");
					div.className = "item";
					div.draggable = true;
					div.textContent = item.emoji;
					div.dataset.category = item.category;
					div.dataset.id = idx;

					div.addEventListener("dragstart", handleDragStart);
					div.addEventListener("dragend", handleDragEnd);

					container.appendChild(div);
				});
			}

			function updateTimer() {
				if (!gameCompleted) {
					timeRemaining--;
					updateTimerDisplay();

					if (timeRemaining <= 0) {
						gameOver();
					}
				}
			}

			function updateTimerDisplay() {
				const timerEl = document.querySelector(".timer");
				document.getElementById("time").textContent = timeRemaining;

				timerEl.classList.remove("warning", "danger");
				if (timeRemaining <= 5) {
					timerEl.classList.add("danger");
				} else if (timeRemaining <= 10) {
					timerEl.classList.add("warning");
				}
			}

			function gameOver() {
				clearInterval(timerInterval);
				gameCompleted = true;
				showMessage("‚è∞ Time's up! YOU'RE ALL DEAD!", "error");

				document.querySelectorAll(".item").forEach((item) => {
					item.draggable = false;
					item.style.opacity = "0.5";
					item.style.cursor = "not-allowed";
				});
			}

			function handleDragStart(e) {
				e.target.classList.add("dragging");
				e.dataTransfer.effectAllowed = "move";
				e.dataTransfer.setData("text/html", e.target.outerHTML);
				e.dataTransfer.setData("category", e.target.dataset.category);
				e.dataTransfer.setData("id", e.target.dataset.id);
			}

			function handleDragEnd(e) {
				e.target.classList.remove("dragging");
			}

			document.querySelectorAll(".category").forEach((cat) => {
				cat.addEventListener("dragover", (e) => {
					e.preventDefault();
					e.dataTransfer.dropEffect = "move";
					cat.classList.add("drag-over");
				});

				cat.addEventListener("dragleave", (e) => {
					cat.classList.remove("drag-over");
				});

				cat.addEventListener("drop", (e) => {
					e.preventDefault();
					cat.classList.remove("drag-over");

					const itemCategory = e.dataTransfer.getData("category");
					const targetCategory = cat.dataset.category;
					const itemId = e.dataTransfer.getData("id");

					const draggedElement = document.querySelector(
						`.item[data-id="${itemId}"]`
					);

					if (draggedElement) {
						// Check if carrot (trap) was dragged
						if (itemCategory === "trap") {
							clearInterval(timerInterval);
							gameCompleted = true;
							showMessage("üíÄ YOU'RE DEAD", "error");

							return;
						}

						const targetContainer = cat.querySelector(".category-items");
						targetContainer.appendChild(draggedElement);

						if (itemCategory === targetCategory) {
							showMessage("Correct! ", "success");
						} else {
							showMessage('YOU"RE ELIMINATED! ', "error");
						}

						checkWin();
					}
				});
			});

			function showMessage(text, type) {
				const msg = document.getElementById("message");
				msg.textContent = text;
				msg.className = `message ${type}`;

				if (type !== "success" || !text.includes("completed")) {
					setTimeout(() => {
						if (
							msg.textContent === text &&
							!text.includes("LOSE") &&
							!text.includes("DEAD")
						) {
							msg.textContent = "";
							msg.className = "message";
						}
					}, 1500);
				}
			}

			function checkWin() {
				const itemsContainer = document.getElementById("itemsContainer");

				// Count only non-trap items
				let nonTrapItemsRemaining = 0;
				itemsContainer.querySelectorAll(".item").forEach((item) => {
					if (item.dataset.category !== "trap") {
						nonTrapItemsRemaining++;
					}
				});

				if (nonTrapItemsRemaining > 0) return;

				let allCorrect = true;

				["fruit", "electronics"].forEach((cat) => {
					const container = document.getElementById(cat);
					const items = container.querySelectorAll(".item");

					items.forEach((item) => {
						if (item.dataset.category !== cat) {
							allCorrect = false;
						}
					});
				});

				if (allCorrect) {
					gameCompleted = true;
					clearInterval(timerInterval);
					const time = 25 - timeRemaining;
					showMessage(`You're all passed!`, "success");

					setTimeout(() => {
						window.location.href = "Final.html";
					}, 2000); // Wait 2000ms (2 seconds)
				}
			}

			initGame();
		</script>
	</body>
</html>
